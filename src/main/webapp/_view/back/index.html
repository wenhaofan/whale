<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>博客后台管理</title>
#@jquery()
#@layui()
<link href="/assets/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/assets/admin/css/style.min.css" rel="stylesheet">
<link href="/assets/plugins/limonte-sweetalert2/6.4.1/sweetalert2.min.css" rel="stylesheet">
<script src="/assets/plugins/limonte-sweetalert2/6.4.1/sweetalert2.min.js"></script>
<script src="/assets/js/base.js?v=v1.0"></script>
<script type="text/javascript" src="/assets/plugins/template/art-template.js"></script>
<script type="text/javascript" src="/assets/js/from-util.js"></script>
<script type="text/javascript" src="/assets/plugins/jquery-pjax/jquery.pjax.js"></script>
<script type="text/javascript">
var fl=new $.fl();
 
$(function(){
	$(".menu-tree li").each(function(){
		if($(this).find("a").attr("href")=="#(requestUrl)"){
			$(this).addClass("layui-this")
		}
	})
	
 $(document).pjax('a[pjax]', '.layui-fluid')
	
	/** $("a").click(function(){
		var pjax=$(this).attr("pjax");
		
		if(pjax==undefined){
			return true;
		}
		
		var href=$(this).attr("href");
		history.pushState(null, $(this).find("span").text(), href);
		
		if(href.indexOf("?")==-1){
			href+="?pjax=true";
		}else{
			href+="&pjax=true";
		}  
	   $.ajax({
		   url:href,
		   dataType:"html",
		   success:function(data){
			  $(".layui-fluid").html(data);
		   }
	   })
	   return false;
	}) **/
	
	
	$(".layui-toggle-menu").click(function(){
		if($(this).find("i").hasClass("layui-icon-spread-left")){
			$(this).find("i").removeClass("layui-icon-spread-left");
			$(this).find("i").addClass("layui-icon-shrink-right");
			$(".layui-side").show();
			$(".layui-body").css("left","200px");
		}else{
			$(this).find("i").addClass("layui-icon-spread-left");
			$(this).find("i").removeClass("layui-icon-shrink-right");
			$(".layui-side").hide();
			$(".layui-body").css("left","0");
		}
	})
	
	$(window).resize(function(){
		if($(window).width()<=768){
			$(".layui-toggle-menu i").addClass("layui-icon-spread-left");
			$(".layui-toggle-menu i").removeClass("layui-icon-spread-right");
			$(".layui-side").hide();
			$(".layui-body").css("left",0);
		}
	})

})


$(function(){
	if($(window).width()<=768){
		$(".layui-toggle-menu i").addClass("layui-icon-spread-left");
		$(".layui-side").hide();
		$(".layui-body").css("left",0);
	}else{
		$(".layui-toggle-menu i").addClass("layui-icon-shrink-right");
		$(".layui-side").show();
	}
})
</script>
<style type="text/css">
.layui-layout-admin .layui-logo{
	left:50px;
	width:150px;
	    text-align: left
}
body{background:#f5f5f5;font-family:'Noto Sans',sans-serif !important;margin:0;color: #505458;}
html{ min-height:100%;background:#f5f5f5}
.menu-tree li a{
    color: #a7b1c2;
    display: block;
    padding:0 0 0 20px!important;
    background: #2f353f;
    font-size: 16px!important;
}
.menu-tree li a i{
    display: inline-block;
    font-size: 18px!important;
    line-height: 17px;
    margin-left: 3px;
    margin-right: 15px;
    text-align: center;
    vertical-align: middle;
    width: 20px;
}
/**为了隐藏在使用bootstrap的模态框和layui的冲突导致的遮罩*/
.modal-backdrop{
	position:static !important;
}
.site-block{
    padding: 20px;
    border: 1px solid #eee;
}

a:hover{
	text-decoration:none !important;
}
.page-title{
	border-style: solid;
    border-width: 1px 1px 1px 5px;
    background: 0 0;
    margin-bottom: 10px;
    padding: 15px;
    line-height: 22px;
    border-left: 5px solid;
    border-radius: 0 2px 2px 0;
    background-color: #f2f2f2;
    border-color: #e6e6e6;
    font-size:16px !important;
}
.right-nva{
	margin-bottom: 24px;
}
.swal2-container{
	z-index:19991015!important;
}
.swal2-modal .swal2-spacer {
	
 	background-color:rgb(255,255,255);
 }

.layui-toggle-menu{
    display: block;
    width: 50px;
    height: 50px;
    text-align: center;
    line-height: 50px;
    color: #fff;
    cursor: pointer;
  
 }
 .layui-toggle-menu i,.layui-logo{
 font-size: 20px;
 }  
 .layui-header{
 	height:50px;
 	
 }
 .layui-nav .layui-layout-right{
	 height:50px;
 }
.layui-layout-admin .layui-logo{
 line-height: 50px;
 }
 .layui-nav .layui-nav-item{
 line-height: 50px;
 }
 .layui-layout-admin .layui-side,.layui-layout-admin .layui-body  {
   top: 50px;
 
}
.layui-layout-admin .layui-body{
bottom: 0px;
}
.layui-bg-black{
	display: none;
}
.update-pwd-from  .layui-input-block,.update-info-from .layui-input-block{
	margin-left:45px;
}
.layui-fluid{
    background-color: #fff;
    box-shadow: 0 2px 2px 0 rgba(0,0,0,0.1);

}
</style>
</head>
<body class=" ">
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
  	<div class="layui-toggle-menu">
  		<i class="layui-icon"></i>
  	</div>
    <div class="layui-logo">博客管理</div>
    <!-- 头部区域（可配合layui已有的水平导航） -->
 
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item">
        <a href="javascript:;">
          
         	欢迎你,#(adminUser.name)
        </a>
        <dl class="layui-nav-child">
           <dd id="updateInfo"><a href="javascript:void(0)">修改个人信息</a></dd>
      	   <dd id="updatePwd"><a href="javascript:void(0)">修改密码</a></dd>
           <dd><a href="/login/logout">退出</a></dd>
        </dl>
      </li>
 
    </ul>
  </div>
  
  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree menu-tree"  >
      	<li class="layui-nav-item"><a href="/admin/statistic" pjax > <i class="layui-icon layui-icon-console"></i><span>控制台</span></a></li>
        <li class="layui-nav-item"><a href="/admin/article/edit"  pjax ><i class="fa fa-pencil-square-o"></i><span>发表文章</span></a></li>
        <li class="layui-nav-item"><a href="/admin/article/list"  pjax ><i class="fa fa-list"></i><span>文章列表</span></a></li>
        <li class="layui-nav-item"><a href="/admin/meta/list"  pjax ><i class="fa fa-tags"></i><span>分类管理</span></a></li>
      	<li class="layui-nav-item"><a href="/admin/disk" pjax ><i class="fa fa-cloud-upload"></i><span>文件管理</span></a></li>
     	<li class="layui-nav-item"><a href="/admin/comment" pjax ><i class="layui-icon layui-icon-reply-fill"></i><span>评论管理</span></a></li>
      	<li class="layui-nav-item"><a href="/admin/nav" pjax ><i class="fa fa-navicon"></i><span>导航管理</span></a></li>
      	<li class="layui-nav-item"><a href="/admin/config" pjax ><i class="layui-icon  layui-icon-set"></i><span>网站设置</span></a></li>
      	<li class="layui-nav-item"><a href="/admin/advancedConfig" pjax ><i class="layui-icon  layui-icon-set"></i><span>高级配置</span></a></li>
      	<li class="layui-nav-item"><a href="/admin/user/edit" pjax ><i class="layui-icon layui-icon-about"></i><span>个人介绍</span></a></li>
     	<li class="layui-nav-item"><a href="/admin/themes" pjax ><i class="layui-icon layui-icon-theme"></i><span>主题配置</span></a></li>
      </ul>
    </div>
  </div>
  
  <div class="layui-body">
    <!-- 内容主体区域 -->
    <div style="padding: 15px;" class=" site-block">
    	<main class="layui-fluid site-block">
    		 #render(includeUrl)
    	</main>	
    </div>
  </div>
 
</div>
<script type="text/html" id="tpl-update-pwd">
<div style="width:290px;padding:10px;">
	<form class="layui-form update-pwd-from" onsubmit="return false;">
		 <div class="layui-form-item layui-form-text">
	   	 	<div class="layui-input-block">
      			<input type="text" name="oldPwd" required  lay-verify="required" placeholder="请输入原密码" autocomplete="off" class="layui-input">
    		</div>
	  	</div>
	  	 <div class="layui-form-item layui-form-text">
	   	 	<div class="layui-input-block">
      			<input type="text" name="newPwd" required  lay-verify="required" placeholder="请输入新密码" autocomplete="off" class="layui-input">
    		</div>
	  	</div>
		  <div class="">
		     <div style="    text-align: center;">
		    	<button class="layui-btn" lay-submit lay-filter="updatePwd">立即提交</button>
			 </div>
	  	</div>
</form>
</div>
</script>
<script type="text/html" id="tpl-update-info">
<div style="width:290px;padding:10px;">
	<form class="layui-form update-info-from" onsubmit="return false;">
		<div class="layui-form-item layui-form-text">
	   	 	<div class="layui-input-block">
      			<input type="text" name="account" required  lay-verify="required" placeholder="请输入登陆账号" autocomplete="off" value="#(adminUser.account)" class="layui-input">
    		</div>
	  	</div>
		 <div class="layui-form-item layui-form-text">
	   	 	<div class="layui-input-block">
      			<input type="text" name="name" required  lay-verify="required" placeholder="请输入姓名" autocomplete="off" value="#(adminUser.name)" class="layui-input">
    		</div>
	  	</div>
	  	 <div class="layui-form-item layui-form-text">
	   	 	<div class="layui-input-block">
      			<input type="text" name="email" required  lay-verify="required" placeholder="请输入邮箱" autocomplete="off" value="#(adminUser.email)" class="layui-input">
    		</div>
	  	</div>
		  <div class="">
		     <div style="text-align: center;">
		    	<button class="layui-btn" lay-submit lay-filter="updateInfo">立即提交</button>
			 </div>
	  	</div>
</form>
</div>
</script>
<script type="text/javascript">
var updatePwdIndex;
layui.use(['form','layer'],function(){
	form=layui.form;
	layer=layui.layer;
	
	  //监听提交
	  form.on('submit(updatePwd)', function(data){
		 
		   $.ajax({
			   url:"/admin/api/user/editPwd",
			   data:data.field,
			   type:"post",
			   success:function(data){
				   if(fl.isOk(data)){
					   fl.alertOk({title:"密码修改成功！"});
					   layer.close(updatePwdIndex);
				   }
			   }
		   })
	  	 return false;
	  });
	  
	  //监听提交
	  form.on('submit(updateInfo)', function(data){
		 
		   $.ajax({
			   url:"/admin/api/user/editInfo",
			   data:data.field,
			   type:"post",
			   success:function(data){
				   if(fl.isOk(data)){
					   fl.alertOk({title:"修改成功！"});
					   layer.close(updatePwdIndex);
				   }
			   }
		   })
	  	 return false;
	  });
})
function updatePwd(){
	updatePwdIndex=layer.open({
  		title:"修改密码",
  		area: ['340px', '215px'],
	  	type: 1, 
	  	content: $("#tpl-update-pwd").html(),
	  	success:function(){
	  		form.render();
	  	}
  	});
}
function updateInfo(){
	updatePwdIndex=layer.open({
  		title:"修改个人信息",
  		area: ['340px', '265px'],
	  	type: 1, 
	  	content: $("#tpl-update-info").html(),
	  	success:function(){
	  		form.render();
	  	}
  	});
}
</script>
<script>

layui.use('element', function(){
  var element = layui.element;
  
  
});

$(function(){
	$("#updatePwd").click(function(){
		updatePwd();
	});
	$("#updateInfo").click(function(){
		updateInfo();
	});
	$(".layui-layout-right").click(function(){
		$(this).trigger("mouseover");
	})
})
</script>


</body>
</html>
      